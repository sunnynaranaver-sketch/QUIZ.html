<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¤ê¹… ì±Œë¦°ì§€: ë±ƒì§€ë¥¼ ëª¨ì•„ë¼!</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        body { font-family: 'Pretendard', sans-serif; text-align: center; padding: 20px; background-color: #f8fafc; color: #334155; }
        .quiz-container { background: white; padding: 40px 20px; border-radius: 24px; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); max-width: 450px; margin: auto; }
        
        /* ë©”ë‹¬ ìŠ¤íƒ€ì¼ */
        .badge-box { display: flex; justify-content: center; gap: 12px; margin-bottom: 30px; background: #f1f5f9; padding: 15px; border-radius: 15px; }
        .badge { width: 55px; height: 55px; filter: grayscale(1) opacity(0.3); transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .badge.active { filter: grayscale(0) opacity(1); transform: scale(1.2); drop-shadow: 0 10px 10px rgba(0,0,0,0.1); }
        
        .question-box { font-size: 1.4rem; font-weight: 700; line-height: 1.5; margin-bottom: 30px; min-height: 80px; color: #1e293b; }
        
        .btn-group { display: flex; justify-content: center; gap: 20px; }
        .btn { width: 100px; height: 100px; font-size: 40px; font-weight: bold; cursor: pointer; border: none; border-radius: 50%; transition: 0.2s; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .btn-o { background-color: #22c55e; color: white; }
        .btn-x { background-color: #ef4444; color: white; }
        .btn:active { transform: scale(0.9); }
        
        .result-msg { font-weight: bold; margin-top: 25px; font-size: 1.3rem; min-height: 30px; }
        .explanation { background: #f0f9ff; padding: 20px; border-radius: 12px; margin-top: 20px; border-left: 5px solid #3b82f6; text-align: left; display: none; line-height: 1.6; }
        #final-screen { display: none; }
        h1 { color: #0f172a; margin-bottom: 10px; }
    </style>
</head>
<body>

<div class="quiz-container">
    <div id="quiz-screen">
        <h2 id="quiz-title" style="color: #64748b; font-size: 1rem; margin-bottom: 10px;">ì¤ê¹… ì±Œë¦°ì§€ í€´ì¦ˆ</h2>
        <div class="badge-box">
            <img src="https://cdn-icons-png.flaticon.com/512/5968/5968923.png" class="badge" id="b1">
            <img src="https://cdn-icons-png.flaticon.com/512/5968/5968923.png" class="badge" id="b2">
            <img src="https://cdn-icons-png.flaticon.com/512/5968/5968923.png" class="badge" id="b3">
            <img src="https://cdn-icons-png.flaticon.com/512/5968/5968923.png" class="badge" id="b4">
            <img src="https://cdn-icons-png.flaticon.com/512/5968/5968923.png" class="badge" id="b5">
        </div>
        
        <div id="question-text" class="question-box">ë¬¸ì œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
        
        <div class="btn-group">
            <button class="btn btn-o" onclick="checkAnswer('O')">O</button>
            <button class="btn btn-x" onclick="checkAnswer('X')">X</button>
        </div>
        
        <div id="feedback" class="result-msg"></div>
        <div id="explanation" class="explanation"></div>
    </div>

    <div id="final-screen">
        <div style="font-size: 80px;">ğŸ†</div>
        <h1>ì±Œë¦°ì§€ ì™„ë£Œ!</h1>
        <p style="font-size: 1.3rem; margin: 20px 0;">ì´ <span id="final-count" style="color:#3b82f6; font-weight:bold;">0</span>ê°œì˜ ë©”ë‹¬ì„ íšë“í–ˆìŠµë‹ˆë‹¤!</p>
        <p>í™˜ê²½ì„ ì§€í‚¤ëŠ” ì†Œì¤‘í•œ ë°œê±¸ìŒ,<br>ì •ë§ ê³ ìƒ ë§ìœ¼ì…¨ìŠµë‹ˆë‹¤! ğŸ‘</p>
        <button onclick="location.href='?quiz=1'" style="margin-top:20px; padding:10px 20px; border-radius:8px; border:1px solid #cbd5e1; background:white; cursor:pointer;">ì²˜ìŒë¶€í„° ë‹¤ì‹œí•˜ê¸°</button>
    </div>
</div>

<script>
    const quizzes = {
        1: { q: "ìš°ë¦¬ë‚˜ë¼ ë¶„ë¦¬ë°°ì¶œ í‘œì‹œ ë§ˆí¬ëŠ” 9ê°€ì§€ì´ë‹¤.", a: "O", desc: "ì •ë‹µì…ë‹ˆë‹¤! ë¬´ìƒ‰PET, í”Œë¼ìŠ¤í‹±, ë¹„ë‹, ì¢…ì´, ì¼ë°˜íŒ©, ë©¸ê· íŒ©, ìœ ë¦¬, ìº”ë¥˜, ì¬í™œìš© ì•ˆë¨ í‘œì‹œê°€ ìˆìŠµë‹ˆë‹¤." },
        2: { q: "ìš°ìœ íŒ©ì€ ì¢…ì´ë¥˜ë¡œ ë¶„ë¦¬ë°°ì¶œí•œë‹¤.", a: "O", desc: "ì •ë‹µì…ë‹ˆë‹¤! ìš°ìœ íŒ©ì€ ì¼ë°˜íŒ©ìœ¼ë¡œ ì¢…ì´ì™€ ë¶„ë¦¬í•˜ì—¬ ë°°ì¶œí•´ì•¼ íœ´ì§€ë¡œ ì¬í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤." },
        3: { q: "ì˜ìˆ˜ì¦ì€ ì¢…ì´ë¥˜ë¡œ ë¶„ë¦¬ë°°ì¶œí•´ì•¼ í•œë‹¤.", a: "X", desc: "ì •ë‹µì…ë‹ˆë‹¤! ì˜ìˆ˜ì¦ì€ ê°ì—´ì§€(í˜¼í•©ì¬ì§ˆ)ë¼ ì¬í™œìš©ì´ ì•ˆ ë˜ì–´ ì¼ë°˜ ì“°ë ˆê¸°ë¡œ ë²„ë ¤ì•¼ í•©ë‹ˆë‹¤." },
        4: { q: "ë°°ë‹¬ ìŒì‹ ìš©ê¸°ì— ë¬»ì€ ìŒì‹ë¬¼ì€ ì”»ì–´ì„œ ë‚´ë†“ì•„ì•¼ í•œë‹¤.", a: "O", desc: "ì •ë‹µì…ë‹ˆë‹¤! ì´ë¬¼ì§ˆì´ ë¬»ìœ¼ë©´ ì¬í™œìš© í’ˆì§ˆì´ ë–¨ì–´ì§€ê±°ë‚˜ ë¶ˆê°€ëŠ¥í•˜ë¯€ë¡œ ë¹„ìš°ê³  í—¹ê¶ˆì•¼ í•©ë‹ˆë‹¤." },
        5: { q: "ê¹¨ì§„ ìœ ë¦¬ëŠ” ìœ ë¦¬ë¥˜ë¡œ ë¶„ë¦¬ë°°ì¶œí•œë‹¤.", a: "X", desc: "ì •ë‹µì…ë‹ˆë‹¤! ê¹¨ì§„ ìœ ë¦¬ëŠ” ì¬í™œìš© ê³µì •ì—ì„œ ìœ„í—˜í•˜ê³  ì„ì¼ ìˆ˜ ì—†ì–´ ì „ìš© ë§ˆëŒ€ë‚˜ ì‹ ë¬¸ì§€ì— ì‹¸ì„œ ì¼ë°˜ ì“°ë ˆê¸°ë¡œ ë²„ë ¤ì•¼ í•©ë‹ˆë‹¤." }
    };

    let earnedBadges = JSON.parse(localStorage.getItem('myBadges')) || [];
    const urlParams = new URLSearchParams(window.location.search);
    const quizId = parseInt(urlParams.get('quiz'));

    if(quizId && quizzes[quizId]) {
        document.getElementById('quiz-title').innerText = `STEP ${quizId} ì§€ì  í€´ì¦ˆ`;
        document.getElementById('question-text').innerText = quizzes[quizId].q;
        updateBadgeUI();
    } else if (urlParams.get('finish')) {
        showFinal();
    } else {
        // ì£¼ì†Œì— íŒŒë¼ë¯¸í„°ê°€ ì—†ì„ ê²½ìš° 1ë²ˆìœ¼ë¡œ ìë™ ìœ ë„
        document.getElementById('question-text').innerText = "QR ì½”ë“œë¥¼ ìŠ¤ìº”í•˜ì—¬ í€´ì¦ˆë¥¼ ì‹œì‘í•´ ì£¼ì„¸ìš”!";
        updateBadgeUI();
    }

    function checkAnswer(userAns) {
        const correct = quizzes[quizId].a;
        const feedback = document.getElementById('feedback');
        const exp = document.getElementById('explanation');
        
        if(userAns === correct) {
            feedback.innerText = "ğŸ‰ ì •ë‹µì…ë‹ˆë‹¤!";
            feedback.style.color = "#22c55e";
            if(!earnedBadges.includes(quizId)) {
                earnedBadges.push(quizId);
                localStorage.setItem('myBadges', JSON.stringify(earnedBadges));
            }
            updateBadgeUI();
            
            // ì •ë‹µì¼ ë•Œ ì‘ì€ í­ì£½ íš¨ê³¼
            confetti({ particleCount: 40, spread: 60, origin: { y: 0.8 } });
        } else {
            feedback.innerText = "ğŸ˜¥ ì•„ì‰¬ì›Œìš”! ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”.";
            feedback.style.color = "#ef4444";
        }
        
        exp.innerText = quizzes[quizId].desc;
        exp.style.display = "block";

        // ëª¨ë“  ë±ƒì§€ë¥¼ ë‹¤ ëª¨ì•˜ë‹¤ë©´ 3ì´ˆ í›„ ì™„ë£Œ í™”ë©´ìœ¼ë¡œ
        if(earnedBadges.length === 5) {
            setTimeout(() => { location.href = "?finish=true"; }, 3500);
        }
    }

    function updateBadgeUI() {
        earnedBadges.forEach(id => {
            const el = document.getElementById(`b${id}`);
            if(el) el.classList.add('active');
        });
    }

    function showFinal() {
        document.getElementById('quiz-screen').style.display = "none";
        document.getElementById('final-screen').style.display = "block";
        document.getElementById('final-count').innerText = earnedBadges.length;
        
        // ìµœì¢… íŒ¡íŒŒë ˆ íš¨ê³¼ (í™”ë ¤í•˜ê²Œ)
        var duration = 5 * 1000;
        var animationEnd = Date.now() + duration;
        var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };

        function randomInRange(min, max) { return Math.random() * (max - min) + min; }

        var interval = setInterval(function() {
            var timeLeft = animationEnd - Date.now();
            if (timeLeft <= 0) return clearInterval(interval);
            var particleCount = 50 * (timeLeft / duration);
            confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } }));
            confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } }));
        }, 250);
    }
</script>
</body>
</html>